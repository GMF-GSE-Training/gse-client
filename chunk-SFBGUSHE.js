import{b as me}from"./chunk-HVBMYJ47.js";import{a as f}from"./chunk-56IKY5DH.js";import{a as pe}from"./chunk-O5IUEWYX.js";import{b as le}from"./chunk-V4ER26SS.js";import"./chunk-3FGHHD2R.js";import{c as X,d as Z,e as $,f as ee,g as ie,k as te,o as ae,q as ne,s as re,t as oe,u as se}from"./chunk-WXCNIMRR.js";import"./chunk-LHQWWVGU.js";import{a as I}from"./chunk-SX5M3CY2.js";import{a as E,b as N}from"./chunk-7SSAWSJY.js";import{a as q}from"./chunk-37HAY2GT.js";import{C,g as L,r as R,t as y,u as J,z as H}from"./chunk-IYTWSHJZ.js";import{Cb as G,Db as K,Eb as U,Fb as Y,Gb as D,Kb as P,Lb as T,Mb as x,Na as d,Ob as z,S as M,Sa as o,Xa as c,Ya as w,ab as V,ba as b,c as S,ca as _,f as B,hb as l,jb as Q,ka as O,nb as s,ob as p,pb as g,sb as W,vb as u,wb as h}from"./chunk-VF5RWILG.js";var Ce=()=>["super admin"],k=(()=>{class a{constructor(t,e,i,n){this.capabilityService=t,this.router=e,this.route=i,this.sweetalertService=n,this.pageTitle="Capability",this.columns=[{header:"Kode Rating",field:"ratingCode"},{header:"Kode Training",field:"trainingCode"},{header:"Nama Training",field:"trainingName"},{header:"Durasi Materi Regulasi GSE",field:"durasiMateriRegulasGSE"},{header:"Durasi Materi Kompetensi",field:"durasiMateriRating"},{header:"Total Durasi",field:"totalDuration"},{header:"Kurikulum & Silabus",field:"kurikulumSilabus"},{header:"Action",field:"action"}],this.capability=[],this.isLoading=!1,this.currentPage=1,this.totalPages=1,this.itemsPerPage=10,this.searchQuery="",this.placeHolder="Cari Capability"}ngOnInit(){this.route.queryParams.subscribe(t=>{this.searchQuery=t.keyword||"",this.currentPage=+t.page||1,this.getListCapability(this.searchQuery,this.currentPage,this.itemsPerPage)})}getListCapability(t,e,i){this.isLoading=!0,this.capabilityService.listCapability(t,e,i).subscribe({next:({data:n,actions:r,paging:ye})=>{this.capability=n.map(m=>({id:m.id,ratingCode:m.ratingCode,trainingCode:m.trainingCode,trainingName:m.trainingName,durasiMateriRegulasGSE:m.totalMaterialDurationRegGse??"-",durasiMateriRating:m.totalMaterialDurationCompetency,totalDuration:m.totalDuration??"-",kurikulumSilabus:`/capability/${m.id}/curriculum-syllabus`,editLink:r?.canEdit?`/capability/${m.id}/edit`:null,deleteMethod:r?.canDelete?()=>this.deleteCapability(m):null})),this.totalPages=ye?.totalPage||1},error:n=>{console.log(n),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}deleteCapability(t){return B(this,null,function*(){(yield this.sweetalertService.confirm("Anda Yakin?",`Apakah anda ingin menghapus capability ini : ${t.trainingName}?`,"warning","Ya, hapus!"))&&(this.sweetalertService.loading("Mohon tunggu","Proses..."),this.capabilityService.deleteCapability(t.id).subscribe({next:()=>{this.sweetalertService.alert("Dihapus!","Data capability berhasil dihapus","success"),this.capability=this.capability.filter(n=>n.id!==t.id),this.capability.length===0&&this.currentPage>0&&(this.currentPage-=1),this.getListCapability(this.searchQuery,this.currentPage,this.itemsPerPage),this.currentPage>this.totalPages&&(this.currentPage=this.totalPages);let i=this.searchQuery?{keyword:this.searchQuery,page:this.currentPage}:{page:this.currentPage};this.router.navigate([],{relativeTo:this.route,queryParams:i,queryParamsHandling:"merge"})},error:()=>{this.sweetalertService.alert("Pemberitahuan","Server sedang sibuk atau terjadi gangguan. Silakan coba beberapa saat lagi.","error")}}))})}onSearchChanged(t){t.trim()===""?this.router.navigate([],{queryParams:{keyword:null,page:null},queryParamsHandling:"merge"}):this.router.navigate([],{queryParams:{keyword:t,page:1},queryParamsHandling:"merge"})}onPageChanged(t){this.router.navigate([],{queryParams:{page:t},queryParamsHandling:"merge"})}viewAll(){this.router.navigate([],{relativeTo:this.route,queryParams:{keyword:void 0,page:void 0},queryParamsHandling:"merge"}),this.searchQuery=""}static{this.\u0275fac=function(e){return new(e||a)(o(f),o(y),o(R),o(C))}}static{this.\u0275cmp=c({type:a,selectors:[["app-capability-list"]],decls:2,vars:10,consts:[[3,"pageChange","searchChange","viewAllChange","pageTitle","columns","data","isLoading","totalPages","currentPage","placeHolder","blueButtonRoute","roleBassedAccess"]],template:function(e,i){e&1&&(g(0,"app-header"),s(1,"app-data-management",0),u("pageChange",function(r){return i.onPageChanged(r)})("searchChange",function(r){return i.onSearchChanged(r)})("viewAllChange",function(){return i.viewAll()}),p()),e&2&&(d(),l("pageTitle",i.pageTitle)("columns",i.columns)("data",i.capability)("isLoading",i.isLoading)("totalPages",i.totalPages)("currentPage",i.currentPage)("placeHolder",i.placeHolder)("blueButtonRoute","/capability/add")("roleBassedAccess",z(9,Ce)))},dependencies:[le,I],encapsulation:2})}}return a})();var fe=["form"];function be(a,he){a&1&&g(0,"app-loader")}function _e(a,he){if(a&1){let t=W();s(0,"div",4),g(1,"app-title",5),s(2,"form",6,0),u("submit",function(){b(t);let i=h();return _(i.onSubmit())}),s(4,"div",7)(5,"div",8)(6,"app-base-input",9,1),x("ngModelChange",function(i){b(t);let n=h();return T(n.capability.ratingCode,i)||(n.capability.ratingCode=i),_(i)}),p(),s(8,"app-base-input",10,2),x("ngModelChange",function(i){b(t);let n=h();return T(n.capability.trainingCode,i)||(n.capability.trainingCode=i),_(i)}),p(),s(10,"app-base-input",11,3),x("ngModelChange",function(i){b(t);let n=h();return T(n.capability.trainingName,i)||(n.capability.trainingName=i),_(i)}),p()()(),s(12,"div",12)(13,"app-white-button",13),D(14,"Kembali"),p(),s(15,"app-blue-button",14),D(16,"Simpan"),p()()()()}if(a&2){let t=Y(3),e=h();d(),l("pageTitle",e.pageTitle),d(5),l("isRequired",!0),P("ngModel",e.capability.ratingCode),d(2),l("isRequired",!0),P("ngModel",e.capability.trainingCode),d(2),l("isRequired",!0),P("ngModel",e.capability.trainingName),d(5),l("disabled",t.invalid)}}var A=(()=>{class a{constructor(){this.capability={},this.pageTitle="",this.isLoading=!1,this.formSubmit=new O}onSubmit(){this.form.valid&&this.formSubmit.emit(this.capability)}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=c({type:a,selectors:[["app-capability-form"]],viewQuery:function(e,i){if(e&1&&G(fe,5),e&2){let n;K(n=U())&&(i.form=n.first)}},inputs:{capability:"capability",pageTitle:"pageTitle",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit"},decls:3,vars:1,consts:[["form","ngForm"],["ratingCode","ngModel"],["trainingCode","ngModel"],["trainingName","ngModel"],[1,"container"],[3,"pageTitle"],[3,"submit"],[1,"form-container"],[1,"input-column"],["label","Kode Rating","type","text","inputMode","text","name","ratingCode","required","","autocomplete","off",3,"ngModelChange","isRequired","ngModel"],["label","Kode Training","type","text","inputMode","text","name","trainingCode","required","","autocomplete","off",3,"ngModelChange","isRequired","ngModel"],["label","Nama Training","type","text","inputMode","text","name","trainingName","required","","autocomplete","name",3,"ngModelChange","isRequired","ngModel"],[1,"container-button"],["type","button","routerLink","/capability",1,"button"],["type","submit",1,"button",3,"disabled"]],template:function(e,i){e&1&&(g(0,"app-header"),V(1,be,1,0,"app-loader")(2,_e,17,8,"div",4)),e&2&&(d(),Q(i.isLoading?1:2))},dependencies:[ne,oe,se,re,ae,ie,X,Z,te,ee,$,L,J,I,pe],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:2em;padding:2em}form[_ngcontent-%COMP%]{background:#fff;padding:2em;border:1px solid #e0e0e0;border-radius:8px;width:100%;margin:25px auto}.form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%}.input-column[_ngcontent-%COMP%]{align-items:center;width:48%}.container-button[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:25px}.button[_ngcontent-%COMP%]{width:190px;height:45px}p[_ngcontent-%COMP%]{color:red}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:2em 1em}form[_ngcontent-%COMP%]{padding:1em}.input-column[_ngcontent-%COMP%]{width:100%}}"]})}}return a})();var j=(()=>{class a{constructor(t,e,i,n){this.capabilityService=t,this.router=e,this.errorHandlerService=i,this.sweetalertService=n,this.capability={id:"",kodeRating:"",kodeTraining:"",namaTraining:""}}onSubmit(t){let n=t,{id:e}=n,i=S(n,["id"]);this.sweetalertService.loading("Mohon tunggu","Proses..."),this.capabilityService.createCapability(i).subscribe({next:r=>{t=r.data,this.sweetalertService.alert("Berhasil!","Capability berhasil dibuat, selanjutnya buat kurikulum & silabus","success"),this.router.navigateByUrl("/curriculum-syllabus/add",{state:{id:t.id,ratingCode:t.ratingCode,trainingName:t.trainingName}})},error:r=>{console.log(r),this.errorHandlerService.alertError(r)}})}static{this.\u0275fac=function(e){return new(e||a)(o(f),o(y),o(q),o(C))}}static{this.\u0275cmp=c({type:a,selectors:[["app-add-capability"]],decls:1,vars:2,consts:[[3,"formSubmit","pageTitle","capability"]],template:function(e,i){e&1&&(s(0,"app-capability-form",0),u("formSubmit",function(r){return i.onSubmit(r)}),p()),e&2&&l("pageTitle","Add Capability")("capability",i.capability)},dependencies:[A],encapsulation:2})}}return a})();var F=(()=>{class a{constructor(t,e,i,n,r){this.capabilityService=t,this.router=e,this.route=i,this.sweetalertService=n,this.errorHandlerService=r,this.capability={id:"",ratingCode:"",trainingCode:"",trainingName:""},this.isLoading=!1}ngOnInit(){let t=this.route.snapshot.paramMap.get("capabilityId");t&&(this.isLoading=!0,this.capabilityService.getCapabilityById(t).subscribe({next:e=>{this.capability=e.data},error:e=>console.log(e),complete:()=>this.isLoading=!1}))}onSubmit(t){let n=t,{id:e}=n,i=S(n,["id"]);this.capabilityService.updateCapability(e,i).subscribe({next:()=>{this.sweetalertService.alert("Berhasil","Capability berhasil diperbarui","success"),this.router.navigateByUrl("/capability")},error:r=>{console.log(r),this.errorHandlerService.alertError(r)}})}static{this.\u0275fac=function(e){return new(e||a)(o(f),o(y),o(R),o(C),o(q))}}static{this.\u0275cmp=c({type:a,selectors:[["app-edit-capability"]],decls:1,vars:3,consts:[[3,"formSubmit","pageTitle","capability","isLoading"]],template:function(e,i){e&1&&(s(0,"app-capability-form",0),u("formSubmit",function(r){return i.onSubmit(r)}),p()),e&2&&l("pageTitle","Edit Capability")("capability",i.capability)("isLoading",i.isLoading)},dependencies:[A],encapsulation:2})}}return a})();var Se=[{path:"",component:k},{path:"add",component:j,canActivate:[E,N],data:{roles:["super admin"]}},{path:":capabilityId/edit",component:F,canActivate:[E,N],data:{roles:["super admin"]}},{path:":capabilityId/curriculum-syllabus",component:me,canActivate:[E,N],data:{roles:["super admin","supervisor","lcu","user"]}}],ge=(()=>{class a{static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275mod=w({type:a})}static{this.\u0275inj=M({imports:[H.forChild(Se),H]})}}return a})();var li=(()=>{class a{static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275mod=w({type:a})}static{this.\u0275inj=M({imports:[L,ge,k,j,F]})}}return a})();export{li as CapabilityModule};
