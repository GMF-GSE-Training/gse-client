import{a as at}from"./chunk-56MELIO2.js";import{a as O}from"./chunk-NOJFPBE5.js";import{a as nt,b as rt}from"./chunk-QBTK6WGW.js";import{a as it}from"./chunk-ACQVVXFN.js";import{a as tt,b as ce}from"./chunk-FXUMVRN2.js";import{a as ot}from"./chunk-4MURGSNB.js";import{b as et}from"./chunk-45L2FNSW.js";import{a as Xe}from"./chunk-D2SHSVYW.js";import{b as Ve,c as re,d as We,e as Ue,f as oe,g as Ke,h as $e,i as He,j as ze,k as pe,n as Qe,o as E,p as Ge,q as Je,s as se,t as Ze,u as le}from"./chunk-UFLICSXF.js";import{b as Ye}from"./chunk-UNQZXZYH.js";import{a as K}from"./chunk-IVJR5BMG.js";import{a as S,b as M}from"./chunk-OWTYBNTC.js";import{a as L}from"./chunk-X734JFNW.js";import{A as B,b as qe,d as U,g as T,j as Ae,n as ae,p as F,r as N,s as ne,x as ve,y as we,z as je}from"./chunk-E6GS5KQF.js";import{Ab as Ee,Cb as q,Db as A,Eb as j,Fb as Le,G as ee,Gb as m,Hb as Re,Ja as Ne,Ka as W,Kb as P,La as Be,Lb as v,M as Q,Mb as w,Na as c,Ob as G,Pb as J,R as ke,Ra as xe,S as te,Sa as d,W as Te,Xa as b,Ya as ie,a as Y,ab as C,b as X,ba as u,ca as h,e as Me,f as Ie,hb as l,ib as be,jb as D,ka as ye,nb as r,o as _e,oa as Fe,ob as p,pb as y,sb as k,t as Ce,vb as g,wb as f,xb as De,yb as Oe,zb as Pe}from"./chunk-NQSGFRSF.js";var I=(()=>{class a{constructor(e){this.http=e,this.apiUrl=we.apiUrl,this.endpoints=we.endpoints.participant}createParticipant(e){return this.http.post(`${this.apiUrl}/${this.endpoints.base}`,e,{withCredentials:!0})}getParticipantById(e){return this.http.get(`${this.apiUrl}/${this.endpoints.base}/${e}`,{withCredentials:!0})}updateParticipant(e,i){return this.http.patch(`${this.apiUrl}/${this.endpoints.base}/${e}`,i,{withCredentials:!0})}deleteParticipant(e){return this.http.delete(`${this.apiUrl}/${this.endpoints.base}/${e}`,{withCredentials:!0})}listParticipants(e,i,t){return this.http.get(`${this.apiUrl}/${this.endpoints.list}?q=${e}&page=${i}&size=${t}`,{withCredentials:!0})}getFile({id:e},i){return this.http.get(`${this.apiUrl}/participants/${e}/${i}`,{responseType:"blob",withCredentials:!0})}getFoto(e){return this.http.get(`${this.apiUrl}/participants/${e}/foto`,{responseType:"blob",withCredentials:!0})}getQrCode(e){return this.http.get(`${this.apiUrl}/participants/${e}/qr-code`,{responseType:"blob",withCredentials:!0})}downloadIdCard(e){return this.http.get(`${this.apiUrl}/${this.endpoints.base}/${e}/${this.endpoints.downloadIdCard}`,{withCredentials:!0,responseType:"blob"})}downloadDocument(e){return this.http.get(`${this.apiUrl}/${this.endpoints.base}/${e}/${this.endpoints.downloadDocument}`,{withCredentials:!0,responseType:"blob"})}viewIdCard(e){return this.http.get(`${this.apiUrl}/${this.endpoints.base}/${e}/${this.endpoints.idCard}`,{responseType:"text",withCredentials:!0})}isDataComplete(e){return this.http.get(`${this.apiUrl}/${this.endpoints.isComplete}/${e}`,{withCredentials:!0})}static{this.\u0275fac=function(i){return new(i||a)(Te(Ae))}}static{this.\u0275prov=ke({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var me=(()=>{class a{constructor(e,i,t,n){this.participantService=e,this.sweetalertService=i,this.router=t,this.route=n,this.pageTitle="Participants",this.columns=[{header:"No Pegawai",field:"idNumber"},{header:"Nama",field:"name"},{header:"Dinas",field:"dinas"},{header:"Bidang",field:"bidang"},{header:"Perusahaan",field:"company"},{header:"Email",field:"email"},{header:"Action",field:"action"}],this.participants=[],this.isLoading=!1,this.currentPage=1,this.totalPages=1,this.itemsPerPage=10,this.searchQuery="",this.placeHolder="Cari Participant",this.roleBassedAccess=["super admin","supervisor","lcu"]}ngOnInit(){this.route.queryParams.subscribe(e=>{this.searchQuery=e.keyword||"",this.currentPage=+e.page||1,this.getListParticipants(this.searchQuery,this.currentPage,this.itemsPerPage)})}getListParticipants(e,i,t){this.isLoading=!0,this.participantService.listParticipants(e,i,t).subscribe({next:n=>{this.participants=this.mapParticipants(n),this.totalPages=n.paging?.totalPage??1},error:n=>{console.log(n),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}deleteParticipant(e){return Ie(this,null,function*(){(yield this.sweetalertService.confirm("Anda Yakin?",`Apakah anda ingin menghapus peserta ini : ${e.name}?`,"warning","Ya, hapus!"))&&(this.sweetalertService.loading("Mohon tunggu","Proses..."),this.participantService.deleteParticipant(e.id).subscribe({next:()=>{this.sweetalertService.alert("Dihapus!","Data peserta berhasil dihapus","success"),this.participants=this.participants.filter(n=>n.id!==e.id),this.participants.length===0&&this.currentPage>0&&(this.currentPage-=1),this.getListParticipants(this.searchQuery,this.currentPage,this.itemsPerPage),this.currentPage>this.totalPages&&(this.currentPage=this.totalPages);let t=this.searchQuery?{keyword:this.searchQuery,page:this.currentPage}:{page:this.currentPage};this.router.navigate([],{relativeTo:this.route,queryParams:t,queryParamsHandling:"merge"})},error:t=>{console.log(t),this.sweetalertService.alert("Gagal!","Terjadi kesalahan, coba lagi nanti","error")}}))})}onSearchChanged(e){e.trim()===""?this.router.navigate([],{queryParams:{keyword:null,page:null},queryParamsHandling:"merge"}):this.router.navigate([],{queryParams:{keyword:e,page:1},queryParamsHandling:"merge"})}onPageChanged(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}viewAll(){this.participants.length>0,this.router.navigate([],{relativeTo:this.route,queryParams:{keyword:void 0,page:void 0},queryParamsHandling:"merge"}),this.searchQuery=""}mapParticipants(e){return e.data.map(i=>X(Y({},i),{idNumber:i.idNumber??"-",dinas:i.dinas??"-",bidang:i.bidang??"-",company:i.company??"-",editLink:e.actions?.canEdit?`/participants/${i.id}/edit`:null,detailLink:e.actions?.canView?`/participants/${i.id}/detail`:null,deleteMethod:e.actions?.canDelete?()=>this.deleteParticipant(i):null}))}static{this.\u0275fac=function(i){return new(i||a)(d(I),d(B),d(N),d(F))}}static{this.\u0275cmp=b({type:a,selectors:[["app-participant-list"]],decls:2,vars:9,consts:[[3,"pageChange","searchChange","viewAllChange","pageTitle","columns","data","isLoading","totalPages","currentPage","placeHolder","blueButtonRoute","roleBassedAccess"]],template:function(i,t){i&1&&(y(0,"app-header"),r(1,"app-data-management",0),g("pageChange",function(s){return t.onPageChanged(s)})("searchChange",function(s){return t.onSearchChanged(s)})("viewAllChange",function(){return t.viewAll()}),p()),i&2&&(c(),l("pageTitle",t.pageTitle)("columns",t.columns)("data",t.participants)("isLoading",t.isLoading)("totalPages",t.totalPages)("currentPage",t.currentPage)("placeHolder",t.placeHolder)("blueButtonRoute","/participants/add")("roleBassedAccess",t.roleBassedAccess))},dependencies:[et,K],encapsulation:2})}}return a})();var ht=["*"];function gt(a,_){a&1&&(r(0,"span"),m(1,"*"),p())}function ft(a,_){if(a&1){let e=k();r(0,"input",7),w("ngModelChange",function(t){u(e);let n=f();return v(n.companyName,t)||(n.companyName=t),h(t)}),p()}if(a&2){let e=f();l("name",e.name)("required",e.showCompanyInput),P("ngModel",e.companyName)}}var V=(()=>{class a{constructor(){this.selectedCompany="",this.showCompanyInput=!1,this.companyName="",this.name="",this.isRequired=!1}ngOnInit(){this.selectedCompany||(this.selectedCompany="GMF",this.toggleCompanyInput())}toggleCompanyInput(){this.showCompanyInput=this.selectedCompany==="Non GMF"}getCompanyName(){return this.selectedCompany==="Non GMF"?this.companyName:"GMF"}static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275cmp=b({type:a,selectors:[["app-company-input"]],inputs:{selectedCompany:"selectedCompany",showCompanyInput:"showCompanyInput",companyName:"companyName",name:"name",isRequired:"isRequired"},ngContentSelectors:ht,decls:11,vars:3,consts:[[1,"container"],["for","company-select"],[4,"ngIf"],["id","company-select",3,"ngModelChange","change","ngModel"],["value","GMF"],["value","Non GMF"],["type","text","id","company-input","placeholder","Nama Perusahaan",3,"name","required","ngModel","ngModelChange",4,"ngIf"],["type","text","id","company-input","placeholder","Nama Perusahaan",3,"ngModelChange","name","required","ngModel"]],template:function(i,t){i&1&&(De(),r(0,"div",0)(1,"label",1),m(2,"Perusahaan "),C(3,gt,2,0,"span",2),p(),r(4,"select",3),w("ngModelChange",function(s){return v(t.selectedCompany,s)||(t.selectedCompany=s),s}),g("change",function(){return t.toggleCompanyInput()}),r(5,"option",4),m(6,"GMF"),p(),r(7,"option",5),m(8,"Non GMF"),p()(),C(9,ft,1,3,"input",6),Oe(10),p()),i&2&&(c(3),l("ngIf",t.isRequired),c(),P("ngModel",t.selectedCompany),c(5),l("ngIf",t.showCompanyInput))},dependencies:[E,He,ze,Ve,$e,re,pe,oe,T,U],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column}label[_ngcontent-%COMP%]{display:flex;margin-top:15px;font-weight:700;font-size:1em}select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:25px;overflow:hidden;width:100%;margin-top:5px;border:3px solid #ccc;height:40px;font-weight:700;padding-left:8px;font-size:15px}span[_ngcontent-%COMP%]{color:red}@media (max-width: 768px){input[_ngcontent-%COMP%]{border:2px solid #ccc}}"]})}}return a})();var _t=["form"];function Ct(a,_){a&1&&(r(0,"span",39),m(1,"SIM A wajib diunggah"),p())}function yt(a,_){a&1&&(r(0,"span",39),m(1,"KTP wajib diunggah"),p())}function bt(a,_){a&1&&(r(0,"span",39),m(1,"Pas Foto wajib diunggah"),p())}function Pt(a,_){a&1&&(r(0,"span",39),m(1,"Surat Ket Sehat dan Buta Warna wajib diunggah"),p())}function vt(a,_){a&1&&(r(0,"span",39),m(1,"Surat Ket Bebas Narkoba wajib diunggah"),p())}var ue=(()=>{class a{constructor(){this.pageTitle="",this.participant={},this.isUpdate=!1,this.fileType=".png, .jpg, .jpeg, .pdf",this.fileTypeFoto=".png, .jpg, .jpeg",this.formSubmit=new ye,this.fileChange=new ye,this.selectedCompany="",this.companyName="",this.showCompanyInput=!1,this.backButtonRoute="/participants",this.cachedUserProfile=JSON.parse(localStorage.getItem("user_profile")||"{}"),this.currentUserRole=this.cachedUserProfile.role?.name}ngOnInit(){this.currentUserRole=this.cachedUserProfile.role?.name}onSubmit(){this.form.valid&&(this.participant.company=this.companyInputComponent.getCompanyName(),this.isUpdate?(this.cachedUserProfile&&this.currentUserRole!=="super admin"&&delete this.participant.email,this.formSubmit.emit(this.participant)):this.formSubmit.emit(this.participant))}onFileChange(e,i){e==="simA"&&(this.participant.simAFileName=i?i.name:null),this.fileChange.emit({property:e,file:i})}static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275cmp=b({type:a,selectors:[["app-participant-form"]],viewQuery:function(i,t){if(i&1&&(q(V,5),q(_t,5)),i&2){let n;A(n=j())&&(t.companyInputComponent=n.first),A(n=j())&&(t.form=n.first)}},inputs:{pageTitle:"pageTitle",participant:"participant",isUpdate:"isUpdate",selectedCompany:"selectedCompany",companyName:"companyName",showCompanyInput:"showCompanyInput",backButtonRoute:"backButtonRoute"},outputs:{formSubmit:"formSubmit",fileChange:"fileChange"},decls:58,vars:57,consts:[["form","ngForm"],["name","ngModel"],["nik","ngModel"],["email","ngModel"],["phoneNumber","ngModel"],["nationality","ngModel"],["placeOfBirth","ngModel"],["dateOfBirth","ngModel"],["tglKeluarSuratSehatButaWarna","ngModel"],["tglKeluarSuratBebasNarkoba","ngModel"],[1,"container"],[3,"pageTitle"],[3,"ngSubmit"],[1,"form-container"],[1,"left-column"],["name","idNumber","label","No Pegawai","placeholder","No Pegawai","type","text","autocomplete","on","inputMode","tel",3,"ngModelChange","ngModel"],["name","name","label","Nama","placeholder","Masukkan nama asli, nama akan digunakan pada data sertifikat","type","text","autocomplete","name","inputMode","text","required","",3,"ngModelChange","ngModel","isRequired","restrictToPattern","pattern"],["name","nik","label","NIK/Paspor","placeholder","Masukkan NIK/Paspor","type","text","autocomplete","NIK","inputMode","text","required","",3,"ngModelChange","ngModel","isRequired","restrictToPattern","pattern"],["name","dinas","label","Dinas","placeholder","Dinas","type","text","autocomplete","dinas","inputMode","text",3,"ngModelChange","ngModel"],["name","bidang","label","Bidang","placeholder","Bidang","type","text","autocomplete","bidang","inputMode","text",3,"ngModelChange","ngModel"],[3,"selectedCompany","companyName","showCompanyInput","isRequired"],["name","email","label","Email","placeholder","Gunakan alamat email aktif","type","email","autocomplete","email","inputMode","text",3,"ngModelChange","ngModel","isRequired","disabled"],["name","phoneNumber","label","Nomor Telepon","placeholder","Gunakan nomor telepon aktif","type","tel","autocomplete","phone","inputMode","tel","pattern","^[0-9+\\- ]+$","required","",3,"ngModelChange","ngModel","isRequired","restrictToPattern"],["name","nationality","label","Kewarganegaraan","placeholder","Isi kewarganegaraan sesuai KTP/Paspor","type","text","autocomplete","country-name","inputMode","text",3,"ngModelChange","ngModel","isRequired"],["name","placeOfBirth","label","Tempat Lahir","placeholder","Isi Tempat Lahir sesuai KTP/Paspor","type","text","autocomplete","address-level2","inputMode","text",3,"ngModelChange","ngModel","isRequired"],[1,"right-column"],["name","dateOfBirth","label","Tanggal Lahir","type","date","inputmode","date","defaultMessage","Isi Tanggal Lahir sesuai KTP/Paspor",3,"ngModelChange","ngModel","isRequired"],["idInput","sim_a_input","label","SIM A",3,"valueChange","isRequired","fileName","fileType","required"],["class","error-message",4,"ngIf"],["idInput","sim_b_input","label","SIM B",3,"valueChange","fileName","fileType"],["idInput","ktp_input","label","KTP/Paspor",3,"valueChange","isRequired","fileName","fileType"],["idInput","foto_input","label","Pas Foto",3,"valueChange","isRequired","fileName","fileType"],["idInput","surat_sehat_input","label","Surat Ket Sehat dan Buta Warna",3,"valueChange","isRequired","fileName","fileType"],["name","tglKeluarSuratSehatButaWarna","label","Tanggal Pembuatan Surat Ket Sehat & Buta Warna","defaultMessage","Masukkan tanggal keluar surat sehat sesuai dengan tanggal keluar surat yang diunggah","type","date","inputmode","date","required","",3,"ngModelChange","ngModel","isRequired"],["idInput","surat_bebas_narkoba_input","label","Surat Ket Bebas Narkoba",3,"valueChange","isRequired","fileName","fileType"],["name","tglKeluarSuratBebasNarkoba","label","Tanggal Pembuatan Surat Ket Bebas Narkoba","defaultMessage","Masukkan tanggal keluar surat sehat sesuai dengan tanggal keluar surat yang diunggah","type","date","inputmode","date","required","",3,"ngModelChange","ngModel","isRequired"],[1,"buttons-container"],["type","button",1,"button",3,"routerLink"],["type","submit",1,"button",3,"disabled"],[1,"error-message"]],template:function(i,t){if(i&1){let n=k();y(0,"app-header"),r(1,"div",10),y(2,"app-title",11),r(3,"form",12,0),g("ngSubmit",function(){return u(n),h(t.onSubmit())}),r(5,"div",13)(6,"div",14)(7,"app-base-input",15),w("ngModelChange",function(o){return u(n),v(t.participant.idNumber,o)||(t.participant.idNumber=o),h(o)}),p(),r(8,"app-base-input",16,1),w("ngModelChange",function(o){return u(n),v(t.participant.name,o)||(t.participant.name=o),h(o)}),p(),r(10,"app-base-input",17,2),w("ngModelChange",function(o){return u(n),v(t.participant.nik,o)||(t.participant.nik=o),h(o)}),p(),r(12,"app-base-input",18),w("ngModelChange",function(o){return u(n),v(t.participant.dinas,o)||(t.participant.dinas=o),h(o)}),p(),r(13,"app-base-input",19),w("ngModelChange",function(o){return u(n),v(t.participant.bidang,o)||(t.participant.bidang=o),h(o)}),p(),y(14,"app-company-input",20),r(15,"app-base-input",21,3),w("ngModelChange",function(o){return u(n),v(t.participant.email,o)||(t.participant.email=o),h(o)}),p(),r(17,"app-base-input",22,4),w("ngModelChange",function(o){return u(n),v(t.participant.phoneNumber,o)||(t.participant.phoneNumber=o),h(o)}),p(),r(19,"app-base-input",23,5),w("ngModelChange",function(o){return u(n),v(t.participant.nationality,o)||(t.participant.nationality=o),h(o)}),p(),r(21,"app-base-input",24,6),w("ngModelChange",function(o){return u(n),v(t.participant.placeOfBirth,o)||(t.participant.placeOfBirth=o),h(o)}),p()(),r(23,"div",25)(24,"app-base-input",26,7),w("ngModelChange",function(o){return u(n),v(t.participant.dateOfBirth,o)||(t.participant.dateOfBirth=o),h(o)}),p(),r(26,"app-file-input",27),g("valueChange",function(o){return u(n),h(t.onFileChange("simA",o))}),p(),C(27,Ct,2,0,"span",28),r(28,"span"),m(29,"Format png, jpg, jpeg, atau pdf."),p(),r(30,"app-file-input",29),g("valueChange",function(o){return u(n),h(t.onFileChange("simB",o))}),p(),r(31,"span"),m(32,"Format png, jpg, jpeg, atau pdf."),p(),r(33,"app-file-input",30),g("valueChange",function(o){return u(n),h(t.onFileChange("ktp",o))}),p(),C(34,yt,2,0,"span",28),r(35,"span"),m(36,"Format png, jpg, jpeg, atau pdf."),p(),r(37,"app-file-input",31),g("valueChange",function(o){return u(n),h(t.onFileChange("foto",o))}),p(),C(38,bt,2,0,"span",28),r(39,"span"),m(40,"Format png, jpg, atau jpeg. ukuran 3x4."),p(),r(41,"app-file-input",32),g("valueChange",function(o){return u(n),h(t.onFileChange("suratSehatButaWarna",o))}),p(),C(42,Pt,2,0,"span",28),r(43,"span"),m(44,"Format png, jpg, jpeg, atau pdf."),p(),r(45,"app-base-input",33,8),w("ngModelChange",function(o){return u(n),v(t.participant.tglKeluarSuratSehatButaWarna,o)||(t.participant.tglKeluarSuratSehatButaWarna=o),h(o)}),p(),r(47,"app-file-input",34),g("valueChange",function(o){return u(n),h(t.onFileChange("suratBebasNarkoba",o))}),p(),C(48,vt,2,0,"span",28),r(49,"span"),m(50,"Format png, jpg, jpeg, atau pdf."),p(),r(51,"app-base-input",35,9),w("ngModelChange",function(o){return u(n),v(t.participant.tglKeluarSuratBebasNarkoba,o)||(t.participant.tglKeluarSuratBebasNarkoba=o),h(o)}),p()()(),r(53,"div",36)(54,"app-white-button",37),m(55,"Kembali"),p(),r(56,"app-blue-button",38),m(57," Simpan "),p()()()()}if(i&2){let n=Le(4);c(2),l("pageTitle",t.pageTitle),c(5),P("ngModel",t.participant.idNumber),c(),P("ngModel",t.participant.name),l("isRequired",!0)("restrictToPattern","^[a-zA-Z ]+$")("pattern","^[a-zA-Z ]+$"),c(2),P("ngModel",t.participant.nik),l("isRequired",!0)("restrictToPattern","^[0-9]+$")("pattern","^[0-9]+$"),c(2),P("ngModel",t.participant.dinas),c(),P("ngModel",t.participant.bidang),c(),l("selectedCompany",t.selectedCompany)("companyName",t.companyName)("showCompanyInput",t.showCompanyInput)("isRequired",!0),c(),P("ngModel",t.participant.email),l("isRequired",!0)("disabled",t.isUpdate&&(!t.currentUserRole||t.currentUserRole!=="super admin")),c(2),P("ngModel",t.participant.phoneNumber),l("isRequired",!0)("restrictToPattern","^[0-9-+ ]+$"),c(2),P("ngModel",t.participant.nationality),l("isRequired",!0),c(2),P("ngModel",t.participant.placeOfBirth),l("isRequired",!0),c(3),P("ngModel",t.participant.dateOfBirth),l("isRequired",!0),c(2),l("isRequired",!0)("fileName",t.participant.simAFileName)("fileType",t.fileType)("required",t.participant.simAFileName),c(),l("ngIf",!t.participant.simAFileName&&n.submitted),c(3),l("fileName",t.participant.simBFileName)("fileType",t.fileType),c(3),l("isRequired",!0)("fileName",t.participant.ktpFileName)("fileType",t.fileType),c(),l("ngIf",!t.participant.ktpFileName&&n.submitted),c(3),l("isRequired",!0)("fileName",t.participant.fotoFileName)("fileType",t.fileTypeFoto),c(),l("ngIf",!t.participant.fotoFileName&&n.submitted),c(3),l("isRequired",!0)("fileName",t.participant.suratSehatButaWarnaFileName)("fileType",t.fileType),c(),l("ngIf",!t.participant.suratSehatButaWarnaFileName&&n.submitted),c(3),P("ngModel",t.participant.tglKeluarSuratSehatButaWarna),l("isRequired",!0),c(2),l("isRequired",!0)("fileName",t.participant.suratBebasNarkobaFileName)("fileType",t.fileType),c(),l("ngIf",!t.participant.suratBebasNarkobaFileName&&n.submitted),c(3),P("ngModel",t.participant.tglKeluarSuratBebasNarkoba),l("isRequired",!0),c(3),l("routerLink",t.backButtonRoute),c(2),l("disabled",n.invalid||!t.participant.simA||!t.participant.ktp||!t.participant.foto||!t.participant.suratSehatButaWarna||!t.participant.suratBebasNarkoba)}},dependencies:[tt,V,le,se,Ze,ne,E,Ke,re,We,pe,Qe,oe,Ue,Je,T,U,K],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:2em;padding:2em}form[_ngcontent-%COMP%]{background:#fff;padding:2em;border:1px solid #e0e0e0;border-radius:8px;max-width:100%}.form-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.left-column[_ngcontent-%COMP%], .right-column[_ngcontent-%COMP%]{width:48%}span[_ngcontent-%COMP%]{margin-left:15px;margin-top:3px;font-size:14px}.error-message[_ngcontent-%COMP%]{color:red}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:2em}.button[_ngcontent-%COMP%]{width:190px;height:45px}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:2em 1em}form[_ngcontent-%COMP%]{padding:1em}.form-container[_ngcontent-%COMP%]{display:block}.left-column[_ngcontent-%COMP%], .right-column[_ngcontent-%COMP%]{width:100%}}"]})}}return a})();var he=(()=>{class a{constructor(e,i,t,n){this.router=e,this.participantService=i,this.sweetalertService=t,this.errorHandlerService=n,this.createParticipant={idNumber:"",name:"",nik:"",dinas:"",bidang:"",company:"",email:"",phoneNumber:"",nationality:"",placeOfBirth:"",dateOfBirth:"",simA:null,simAFileName:"",simB:null,simBFileName:"",ktp:null,ktpFileName:"",foto:null,fotoFileName:"",suratSehatButaWarna:null,suratSehatButaWarnaFileName:"",suratBebasNarkoba:null,suratBebasNarkobaFileName:"",tglKeluarSuratSehatButaWarna:"",tglKeluarSuratBebasNarkoba:""},this.requiredFields=["name","company","email","phoneNumber","kewarganegaraan","placeOfBirth","dateOfBirth","simA","ktp","foto","suratSehatButaWarna","tglKeluarSuratSehatButaWarna","suratBebasNarkoba","tglKeluarSuratSehatBebasNarkoba"]}onCreate(e){let i=this.prepareFormData(e);this.sweetalertService.loading("Mohon tunggu","Proses..."),this.participantService.createParticipant(i).subscribe({next:t=>{let n=t.data;this.sweetalertService.alert("Ditambahkan!","Peserta berhasil ditambahkan","success"),this.router.navigateByUrl("/users/add",{state:{id:n.id,idNumber:n.idNumber,nik:n.nik,email:n.email,name:n.name,dinas:n.dinas}})},error:t=>{this.errorHandlerService.alertError(t,this.requiredFields)}})}onFileChange(e,i){if(i){this.createParticipant[e]=i;let t=`${e}FileName`;this.createParticipant[t]=i.name}}prepareFormData(e){let i=new FormData;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];n==null&&(n=""),(n instanceof File||n)&&i.append(t,n)}return i}static{this.\u0275fac=function(i){return new(i||a)(d(N),d(I),d(B),d(L))}}static{this.\u0275cmp=b({type:a,selectors:[["app-add-participant-data"]],viewQuery:function(i,t){if(i&1&&q(V,5),i&2){let n;A(n=j())&&(t.companyInputComponent=n.first)}},decls:1,vars:2,consts:[[3,"formSubmit","fileChange","pageTitle","participant"]],template:function(i,t){i&1&&(r(0,"app-participant-form",0),g("formSubmit",function(s){return t.onCreate(s)})("fileChange",function(s){return t.onFileChange(s.property,s.file)}),p()),i&2&&l("pageTitle","Add Participant Data")("participant",t.createParticipant)},dependencies:[E,ue],encapsulation:2})}}return a})();var lt=Me(at());var wt=()=>["super admin","supervisor","lcu"],St=()=>["user"],Mt=()=>["super admin","lcu","supervisor"],It=()=>["super admin","lcu","user"],st=a=>({active:a}),kt=a=>["/participants",a,"profile","personal"],Tt=a=>["/participants",a,"profile","account"];function Ft(a,_){a&1&&y(0,"app-loader")}function Nt(a,_){a&1&&(r(0,"div",23),m(1,"Data peserta tidak ditemukan."),p())}function Bt(a,_){if(a&1&&y(0,"img",5),a&2){let e=f(2);Ee("src","data:",e.photoType,"/;base64,",e.pasFoto,"",W)}}function xt(a,_){if(a&1&&y(0,"img",24),a&2){let e=f(2);be("blank",!e.pasFoto)}}function Dt(a,_){if(a&1&&(r(0,"span",25)(1,"span"),m(2,"Cetak Kartu Peserta"),p()()),a&2){let e=f(2);l("routerLink",e.idCardLink)}}function Ot(a,_){if(a&1&&(r(0,"div",26)(1,"div",27),y(2,"i",28),r(3,"span"),m(4,"Data Pribadi"),p()(),r(5,"div",27),y(6,"i",29),r(7,"span"),m(8,"Akun"),p()()()),a&2){let e=f(2);c(),l("ngClass",J(4,st,e.selectedItem===0))("routerLink",J(6,kt,e.id)),c(4),l("ngClass",J(8,st,e.selectedItem===1))("routerLink",J(10,Tt,e.id))}}function Et(a,_){if(a&1){let e=k();r(0,"app-vertical-table",30),g("downloadDocumentClick",function(){u(e);let t=f(2);return h(t.downloadDocument())}),p()}if(a&2){let e=f(2);l("isParticipantDetail",!0)("data",e.verticalTableData)}}function Lt(a,_){if(a&1){let e=k();r(0,"div",18)(1,"div",31)(2,"app-email-form-card",32),g("formSubmit",function(t){u(e);let n=f(2);return h(n.updateEmailSubmit(t))}),p()(),r(3,"div",31)(4,"app-password-update-form-card",33),g("formSubmit",function(t){u(e);let n=f(2);return h(n.updatePasswordSubmit(t))}),p()()()}}function Rt(a,_){if(a&1&&(r(0,"app-white-button",34),m(1,"Kembali"),p()),a&2){let e=f(2);l("routerLink",e.backButtonRoute||"/participants")}}function qt(a,_){if(a&1&&(r(0,"app-blue-button",34),m(1,"Edit"),p()),a&2){let e=f(2);l("routerLink",e.editLink)}}function At(a,_){if(a&1&&(C(0,Nt,2,0,"div",1),r(1,"div",2)(2,"div",3)(3,"div",4),C(4,Bt,1,3,"img",5)(5,xt,1,2,"img",6),p(),r(6,"div",7)(7,"h2"),m(8),p()()(),r(9,"div",8)(10,"div",9),y(11,"img",10),p(),r(12,"div",11),C(13,Dt,3,1,"span",12),r(14,"span")(15,"a",13),m(16,"Download"),p()()()()(),r(17,"div",14),C(18,Ot,9,12,"div",15),r(19,"div",16),C(20,Et,1,2,"app-vertical-table",17)(21,Lt,5,0,"div",18),p()(),r(22,"div",19),y(23,"app-table",20),p(),r(24,"div",21),C(25,Rt,2,1,"app-white-button",22)(26,qt,2,1,"app-blue-button",22),p()),a&2){let e=f();l("ngIf",!e.participant&&!e.isLoading),c(4),D(e.pasFoto?4:5),c(4),Re(e.participant==null?null:e.participant.name),c(3),Pe("src","data:image/png;base64,",e.qrCode,"",W),c(2),l("appRoleBasedAccess",G(14,wt)),c(2),Pe("href","data:image/png;base64,",e.qrCode,"",W),c(3),l("appRoleBasedAccess",G(15,St)),c(2),D(e.selectedItem===0?20:e.selectedItem===1?21:-1),c(3),l("columns",e.columns)("data",e.data),c(2),l("appRoleBasedAccess",G(16,Mt)),c(),l("appRoleBasedAccess",G(17,It))}}var H=(()=>{class a{constructor(e,i,t,n,s,o){this.route=e,this.router=i,this.participantService=t,this.authService=n,this.sweetalertService=s,this.errorHandlerService=o,this.participant=null,this.verticalTableData=[],this.editLink="",this.photoType=null,this.backButtonRoute="/participants",this.selectedItem=0,this.isLoading=!1,this.pasFoto=localStorage.getItem("pas_foto"),this.qrCode=localStorage.getItem("qr_code"),this.id=this.route.snapshot.paramMap.get("participantId")||JSON.parse(localStorage.getItem("user_profile")||"{}").participant.id,this.idCardLink="",this.dateOptions={day:"numeric",month:"long",year:"numeric"},this.columns=[{header:"Kompetensi",field:"trainingName"},{header:"Exp Sertifikat",field:"exp"}],this.data=[{trainingName:"Forklift",exp:"10 February 2026"},{trainingName:"Regulasi GSE",exp:"10 February 2026"},{trainingName:"Baggage Towing Tractor",exp:"10 February 2026"},{trainingName:"Air Conditioning System Refreshment",exp:"10 February 2026"}],this.userProfile=JSON.parse(localStorage.getItem("user_profile")||"{}"),this.updateEmail={email:""};let z=this.router.getCurrentNavigation()?.extras.state;z&&(this.backButtonRoute=z.data)}ngOnInit(){this.route.queryParams.subscribe(e=>{e.error?(this.sweetalertService.alert("Gagal",e.error,"error"),this.router.navigate([],{relativeTo:this.route,queryParams:{error:null},queryParamsHandling:"merge"})):e.success&&(this.sweetalertService.alert("Sukses",e.success,"success"),this.getParticipantById(),this.router.navigate([],{relativeTo:this.route,queryParams:{success:null},queryParamsHandling:"merge"}))}),this.route.url.subscribe(e=>{let i=e.map(t=>t.path).join("/");this.selectedItem=i===`participants/${this.id}/profile/personal`?0:i===`participants/${this.id}/profile/account`?1:0}),this.userProfile.role.name==="user"?this.id!==this.userProfile.participant.id?this.getParticipantById():this.getParticipantFromLocalStorage():this.getParticipantById()}getParticipantFromLocalStorage(){this.isLoading=!0,this.participant=this.userProfile.participant,this.participant&&this.setParticipantData(this.participant),this.isLoading=!1}getParticipantById(){this.isLoading=!0,this.participantService.getParticipantById(this.id).subscribe({next:e=>{e.data?this.setParticipantData(e.data):this.participant=null},error:e=>{console.error(e),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}getFoto(e){this.participantService.getFoto(e).pipe(Ce(i=>new Promise((t,n)=>{let s=new FileReader;s.onloadend=()=>t(s.result),s.onerror=n,s.readAsDataURL(i)})),Q(i=>_e(i))).subscribe({next:i=>{this.photoType=this.getMediaType(i),this.pasFoto=i.split(",")[1],this.userProfile.role.name==="user"&&localStorage.setItem("pas_foto",this.pasFoto)},error:i=>console.error("Error fetching photo:",i)})}getQrCode(e){this.participantService.getQrCode(e).pipe(Ce(i=>new Promise((t,n)=>{let s=new FileReader;s.onloadend=()=>t(s.result),s.onerror=n,s.readAsDataURL(i)})),Q(i=>_e(i))).subscribe({next:i=>{this.qrCode=i.split(",")[1],this.userProfile.role.name==="user"&&localStorage.setItem("qr_code",this.qrCode)},error:i=>console.error("Error fetching QR code:",i)})}downloadDocument(){this.id&&(this.sweetalertService.loading("Mohon tunggu","Proses..."),this.participantService.downloadDocument(this.id).subscribe({next:e=>{(0,lt.default)(e),this.sweetalertService.close()},error:e=>this.errorHandlerService.alertError(e)}))}updateEmailSubmit(e){this.sweetalertService.loading("Mohon tunggu","Proses..."),this.authService.updateEmailRequest(e).subscribe({next:()=>{this.sweetalertService.alert("Berhasil",`Kami telah mengirimkan email verifikasi ke ${e.email}. Silakan buka tautan untuk menyelesaikan proses.`,"success")},error:i=>this.errorHandlerService.alertError(i)})}updatePasswordSubmit(e){this.sweetalertService.loading("Mohon tunggu","Proses..."),this.authService.updatePassword(e).subscribe({next:()=>{this.sweetalertService.alert("Berhasil","Password berhasil diubah","success")},error:i=>this.errorHandlerService.alertError(i)})}setParticipantData(e){this.participant=e,this.editLink=`/participants/${this.participant.id}/edit`,this.idCardLink=`/participants/${this.participant.id}/id-card`,this.verticalTableData=[{label:"No Pegawai",value:this.participant.idNumber??"-"},{label:"Nama Peserta",value:this.participant.name},{label:"Dinas",value:this.participant.dinas??"-"},{label:"Bidang",value:this.participant.bidang??"-"},{label:"Perusahaan",value:this.participant.company??"-"},{label:"Email",value:this.participant.email},{label:"No Telp",value:this.participant.phoneNumber??"-"},{label:"Tempat Lahir",value:this.participant.placeOfBirth??"-"},{label:"Tanggal Lahir",value:new Date(this.participant.dateOfBirth).toLocaleDateString("id-ID",this.dateOptions)},{label:"SIM A",link:`/participants/${this.participant.id}/sim-a`},{label:"SIM B",link:`/participants/${this.participant.id}/sim-b`},{label:"KTP",link:`/participants/${this.participant.id}/ktp`},{label:"Exp Surat Sehat & Buta Warna",value:new Date(new Date(this.participant.tglKeluarSuratSehatButaWarna).setMonth(new Date(this.participant.tglKeluarSuratSehatButaWarna).getMonth()+6)).toLocaleDateString("id-ID",this.dateOptions),link:`/participants/${this.participant.id}/surat-sehat-buta-warna`},{label:"Exp Surat Bebas Narkoba",value:new Date(new Date(this.participant.tglKeluarSuratBebasNarkoba).setMonth(new Date(this.participant.tglKeluarSuratBebasNarkoba).getMonth()+6)).toLocaleDateString("id-ID",this.dateOptions),link:`/participants/${this.participant.id}/surat-bebas-narkoba`}],this.pasFoto||this.getFoto(this.participant.id),this.qrCode||this.getQrCode(this.participant.id)}getMediaType(e){let i=e.match(/data:(.*?);/);return i?i[1]:""}static{this.\u0275fac=function(i){return new(i||a)(d(F),d(N),d(I),d(je),d(B),d(L))}}static{this.\u0275cmp=b({type:a,selectors:[["app-participant-detail"]],decls:4,vars:3,consts:[[1,"container"],["class","error-message",4,"ngIf"],[1,"section"],[1,"profile-section"],[1,"photo"],["alt","Profile Picture",1,"file",3,"src"],["src","../../../../assets/image/blank_profile_picture.png","alt","Profile Picture",1,"file",3,"blank"],[1,"name"],[1,"qr-section"],[1,"qr-code"],["alt","QR Code",1,"file",3,"src"],[1,"download"],[3,"routerLink",4,"appRoleBasedAccess"],["download","QR_Code.png",3,"href"],[1,"data-section"],["class","settings-nav",4,"appRoleBasedAccess"],[1,"card"],[3,"isParticipantDetail","data"],[1,"account-form"],[1,"certificate-table"],[3,"columns","data"],[1,"button-container"],["class","button",3,"routerLink",4,"appRoleBasedAccess"],[1,"error-message"],["src","../../../../assets/image/blank_profile_picture.png","alt","Profile Picture",1,"file"],[3,"routerLink"],[1,"settings-nav"],[1,"menu-setting-item",3,"ngClass","routerLink"],[1,"fa-solid","fa-user"],[1,"fa-solid","fa-user-gear"],[3,"downloadDocumentClick","isParticipantDetail","data"],[1,"form-content"],["cardTitle","Ubah Email",3,"formSubmit"],["cardTitle","Ubah Password",3,"formSubmit"],[1,"button",3,"routerLink"]],template:function(i,t){i&1&&(y(0,"app-header"),r(1,"div",0),C(2,Ft,1,0,"app-loader")(3,At,27,18),p()),i&2&&(c(),be("loading",t.isLoading),c(),D(t.isLoading?2:3))},dependencies:[ne,se,it,Ye,Xe,T,qe,U,le,nt,rt,ot,K],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:2em;padding:2em}.container.loading[_ngcontent-%COMP%]{justify-content:center;align-items:center;height:50%;width:100%}.section[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:40%}.profile-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.photo[_ngcontent-%COMP%]{max-width:148px;max-height:100%}.name[_ngcontent-%COMP%]{font-size:1em;margin-top:10px}.qr-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1em}.file[_ngcontent-%COMP%]{width:100%;height:100%}.file.blank[_ngcontent-%COMP%]{border:1px solid #fff}.qr-code[_ngcontent-%COMP%]{max-width:180px;max-height:180px}.download[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:25px;font-size:1em;font-weight:700;text-decoration:underline}.data-section[_ngcontent-%COMP%]{display:flex;gap:1em}.settings-nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:top;font-size:1em;width:12%}.settings-nav[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{height:50px}.menu-setting-item[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;gap:10px;cursor:pointer;transition:background-color .2s ease,border-left .2s ease}.menu-setting-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:1em}.menu-setting-item[_ngcontent-%COMP%]:hover{background-color:#d8dadb}.menu-setting-item.active[_ngcontent-%COMP%]{border-left:5px solid #02507E}.card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;height:100%;width:100%;background-color:#fff}.account-form[_ngcontent-%COMP%]{display:flex;padding:20px;gap:5%}.form-content[_ngcontent-%COMP%]{margin:0;width:100%;height:auth;padding-right:10%}.certificate-table[_ngcontent-%COMP%]{width:100%;padding:20px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fff}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%}.button[_ngcontent-%COMP%]{width:190px;height:45px}.download[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000}.download[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{cursor:pointer;color:#266e99}.section[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.section[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{cursor:pointer;color:#266e99}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:1em}.qr-section[_ngcontent-%COMP%]{flex-direction:column}.data-section[_ngcontent-%COMP%]{flex-direction:column;gap:1em}.settings-nav[_ngcontent-%COMP%]{flex-direction:row;width:50%}.menu-setting-item.active[_ngcontent-%COMP%]{border-left:none;border-bottom:5px solid #02507E}.account-form[_ngcontent-%COMP%]{flex-direction:column;gap:3em}}"]})}}return a})();var ge=(()=>{class a{constructor(e,i,t,n,s){this.route=e,this.router=i,this.participantService=t,this.sweetalertService=n,this.errorHandlerService=s,this.updateParticipant={idNumber:"",name:"",nik:"",dinas:"",bidang:"",company:"",phoneNumber:"",nationality:"",placeOfBirth:"",dateOfBirth:"",simA:null,simAFileName:"",simB:null,simBFileName:"",ktp:null,ktpFileName:"",foto:null,fotoFileName:"",suratSehatButaWarna:null,suratSehatButaWarnaFileName:"",suratBebasNarkoba:null,suratBebasNarkobaFileName:"",tglKeluarSuratSehatButaWarna:null,tglKeluarSuratBebasNarkoba:null},this.participantId=this.route.snapshot.paramMap.get("participantId"),this.selectedCompany="",this.companyName="",this.showCompanyInput=!1,this.requiredFields=["name","company","email","phoneNumber","kewarganegaraan","placeOfBirth","dateOfBirth","simA","ktp","foto","suratSehatButaWarna","tglKeluarSuratSehatButaWarna","suratBebasNarkoba","tglKeluarSuratSehatBebasNarkoba"],this.userProfile=JSON.parse(localStorage.getItem("user_profile")||"{}"),this.id=this.route.snapshot.paramMap.get("participantId")||this.userProfile.participant.id,this.backButtonRoute="/participants"}ngOnInit(){this.participantId&&this.userProfile!=="{}"&&(this.userProfile.role==="user"?this.getParticipantFromLocalStorage():this.getParticipantById()),this.route.queryParams.subscribe(e=>{e.showAlert&&(this.sweetalertService.alert("Peringatan","Anda tidak bisa mengakses halaman lain sebelum melengkapi data","warning"),this.router.navigate([],{relativeTo:this.route,queryParams:{showAlert:null},queryParamsHandling:"merge"}))}),this.id&&this.userProfile.role.name==="user"&&(this.backButtonRoute=`/participants/${this.id}/profile/personal`)}getParticipantFromLocalStorage(){let e=this.userProfile.participant;e&&this.setParticipantData(e)}getParticipantById(){this.participantId&&this.participantService.getParticipantById(this.participantId).subscribe({next:e=>{let i=e.data;i&&this.setParticipantData(i)},error:e=>console.log(e)})}onUpdate(e){if(this.participantId){let i=this.prepareFormData(e);this.sweetalertService.loading("Mohon tunggu","Proses..."),this.participantService.updateParticipant(this.participantId,i).subscribe({next:()=>{this.sweetalertService.alert("Diperbarui!","Peserta berhasil diperbarui","success");let t=this.userProfile.participant;if(t){let n=t.email;this.userProfile.participant=JSON.parse(JSON.stringify(e,(s,o)=>o instanceof File||o===null?void 0:o)),this.userProfile.participant.email=n,this.userProfile.isDataComplete=!0,localStorage.setItem("user_profile",JSON.stringify(this.userProfile))}this.userProfile.role.name==="user"?(localStorage.removeItem("pas_foto"),localStorage.removeItem("qr_code"),this.router.navigateByUrl(`/participants/${this.participantId}/profile/personal`)):this.router.navigateByUrl(`/participants/${this.participantId}/detail`)},error:t=>{console.log(t),this.errorHandlerService.alertError(t,this.requiredFields)}})}}onFileChange(e,i){if(i){this.updateParticipant[e]=i;let t=`${e}FileName`;this.updateParticipant[t]=i.name}}setParticipantData(e){this.updateParticipant=X(Y({},e),{dateOfBirth:this.formatDateToISO(e.dateOfBirth),tglKeluarSuratSehatButaWarna:this.formatDateToISO(e.tglKeluarSuratSehatButaWarna),tglKeluarSuratBebasNarkoba:this.formatDateToISO(e.tglKeluarSuratBebasNarkoba)}),this.selectedCompany=e.gmfNonGmf?e.gmfNonGmf:e.company,(e.gmfNonGmf!=="GMF"||e.company!=="GMF")&&(this.companyName=e.company,this.showCompanyInput=!!this.companyName,this.companyName||(this.selectedCompany="GMF",this.companyName="GMF",this.showCompanyInput=!1))}prepareFormData(e){let i=new FormData;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];n==null&&(n=""),n instanceof File,i.append(t,n)}return i}formatDateToISO(e){return new Date(e).toISOString().split("T")[0]}static{this.\u0275fac=function(i){return new(i||a)(d(F),d(N),d(I),d(B),d(L))}}static{this.\u0275cmp=b({type:a,selectors:[["app-edit-participant-data"]],viewQuery:function(i,t){if(i&1&&q(V,5),i&2){let n;A(n=j())&&(t.companyInputComponent=n.first)}},inputs:{selectedCompany:"selectedCompany",companyName:"companyName",showCompanyInput:"showCompanyInput"},decls:1,vars:7,consts:[[3,"formSubmit","fileChange","pageTitle","selectedCompany","companyName","showCompanyInput","participant","isUpdate","backButtonRoute"]],template:function(i,t){i&1&&(r(0,"app-participant-form",0),g("formSubmit",function(s){return t.onUpdate(s)})("fileChange",function(s){return t.onFileChange(s.property,s.file)}),p()),i&2&&l("pageTitle","Edit Participant Data")("selectedCompany",t.selectedCompany)("companyName",t.companyName)("showCompanyInput",t.showCompanyInput)("participant",t.updateParticipant)("isUpdate",!0)("backButtonRoute",t.backButtonRoute)},dependencies:[ue],encapsulation:2})}}return a})();var ct=Me(at());function Vt(a,_){if(a&1&&y(0,"div",1),a&2){let e=f();l("innerHTML",e.id_card,Ne)}}function Wt(a,_){a&1&&(r(0,"div",2)(1,"p"),m(2,"ID Card Error. Silahkan cek kembali apakah data anda sudah lengkap atau belum."),p()())}var fe=(()=>{class a{constructor(e,i,t,n,s){this.route=e,this.participantService=i,this.sanitizer=t,this.sweetalertService=n,this.errorHandlerService=s,this.id_card="",this.id=this.route.snapshot.paramMap.get("participantId"),this.navigationLink=`/participants/${this.id}/detail`,this.isLoading=!1}ngOnInit(){this.getIdCard()}getIdCard(){if(!this.id){this.sweetalertService.alert("Peringatan","ID tidak ditemukan.","warning");return}this.isLoading=!0,this.participantService.viewIdCard(this.id).subscribe({next:e=>{this.id_card=this.sanitizer.bypassSecurityTrustHtml(e)},error:e=>{console.log(e),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}downloadIdCard(){if(!this.id){this.sweetalertService.alert("Peringatan","ID tidak ditemukan.","warning");return}this.sweetalertService.loading("Mohon tunggu","Proses..."),this.participantService.getParticipantById(this.id).pipe(ee(()=>this.sweetalertService.close())).subscribe({next:e=>{if(e.data){let n=`ID_Card_${e.data.name.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"")}_${this.id}.pdf`;this.participantService.downloadIdCard(this.id).subscribe({next:s=>{s?((0,ct.saveAs)(s,n),console.log(`File saved as: ${n}`)):this.sweetalertService.alert("Gagal!","Tidak ada data untuk diunduh.","error")},error:s=>{console.error("Error saat mengunduh ID Card:",s),this.errorHandlerService.alertError(s)}})}else this.sweetalertService.alert("Gagal!","Data peserta tidak ditemukan.","error")},error:e=>{console.error("Error saat mengambil detail peserta:",e),this.errorHandlerService.alertError(e)}})}static{this.\u0275fac=function(i){return new(i||a)(d(F),d(I),d(ae),d(B),d(L))}}static{this.\u0275cmp=b({type:a,selectors:[["app-id-card"]],decls:3,vars:3,consts:[["pageTitle","ID Card",3,"downloadChange","isLoading","navigationLinks"],[3,"innerHTML"],[1,"no-files"]],template:function(i,t){i&1&&(r(0,"app-display-files",0),g("downloadChange",function(){return t.downloadIdCard()}),C(1,Vt,1,1,"div",1)(2,Wt,3,0,"div",2),p()),i&2&&(l("isLoading",t.isLoading)("navigationLinks",t.navigationLink),c(),D(t.id_card?1:2))},dependencies:[ce],styles:[".no-files[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:2em;height:50vh}"]})}}return a})();function Ut(a,_){if(a&1){let e=k();r(0,"embed",4),g("load",function(){u(e);let t=f(2);return h(t.onImageLoad())})("error",function(){u(e);let t=f(2);return h(t.onImageError())}),p()}if(a&2){let e=f(2);l("src",e.safeUrl,Be)}}function Kt(a,_){if(a&1){let e=k();r(0,"img",5),g("load",function(){u(e);let t=f(2);return h(t.onImageLoad())})("error",function(){u(e);let t=f(2);return h(t.onImageError())}),p()}if(a&2){let e=f(2);l("src",e.safeUrl,W)}}function $t(a,_){if(a&1&&C(0,Ut,1,1,"embed",2)(1,Kt,1,1,"img",3),a&2){let e=f();D(e.fileType==="application/pdf"?0:1)}}function Ht(a,_){a&1&&(r(0,"div",1)(1,"p"),m(2,"File tidak ditemukan!!"),p()())}var R=(()=>{class a{constructor(e,i,t,n,s,o){this.route=e,this.participantService=i,this.router=t,this.sanitizer=n,this.renderer=s,this.el=o,this.pageTitle="",this.id=this.route.snapshot.paramMap.get("participantId"),this.navigationLink="",this.fileType="",this.safeUrl="",this.cachedUserProfile=localStorage.getItem("user_profile"),this.isLoading=!1;let z=this.router.getCurrentNavigation()?.extras.state;z?this.navigationLink=z.data:this.cachedUserProfile&&(JSON.parse(this.cachedUserProfile).role.name==="user"?this.navigationLink=`/participants/${this.id}/profile/personal`:this.navigationLink=`/participants/${this.id}/detail`)}ngOnInit(){let e=this.router.url,t=["sim-a","sim-b","ktp","surat-sehat-buta-warna","surat-bebas-narkoba"].find(n=>e.includes(n));t&&(this.pageTitle=t.toUpperCase().split("-").join(" "),this.id&&this.getFile(this.id,t))}getFile(e,i){this.isLoading=!0,this.participantService.getFile({id:e},i).pipe(Q(t=>(this.fileType=this.getMediaType(t),new Promise((n,s)=>{let o=new FileReader;o.onloadend=()=>n(o.result),o.onerror=s,o.readAsDataURL(t)}))),ee(()=>{this.isLoading=!1})).subscribe({next:t=>{this.file=t.split(",")[1],this.fileType==="application/pdf"?this.safeUrl=this.sanitizer.bypassSecurityTrustResourceUrl(`data:${this.fileType};base64,${this.file}#toolbar=0`):this.safeUrl=this.sanitizer.bypassSecurityTrustResourceUrl(`data:${this.fileType};base64,${this.file}`)},error:t=>{console.log(t)}})}onImageLoad(){this.isLoading=!1}onImageError(){console.log("Failed to load image:",this.safeUrl),this.isLoading=!1}getMediaType(e){return e.type==="application/pdf"?"application/pdf":e.type==="image/jpeg"?"image/jpeg":e.type==="image/png"?"image/png":e.type==="image/gif"?"image/gif":e.type==="image/bmp"?"image/bmp":e.type==="image/webp"?"image/webp":"application/octet-stream"}getDownloadExtension(){switch(this.fileType){case"image/png":return".png";case"image/jpeg":return".jpeg";case"image/gif":return".gif";case"image/bmp":return".bmp";case"image/webp":return".webp";case"application/pdf":return".pdf";default:return""}}downloadFile(){if(!this.file||!this.fileType){console.error("File content or type is missing, cannot download.");return}let e=`data:${this.fileType};base64,${this.file}`,i=this.renderer.createElement("a");this.renderer.setAttribute(i,"href",e),this.renderer.setAttribute(i,"download",`${(this.pageTitle||"file").replace(/\s+/g,"_")}${this.getDownloadExtension()}`),this.renderer.appendChild(this.el.nativeElement,i),i.click(),this.renderer.removeChild(this.el.nativeElement,i)}static{this.\u0275fac=function(i){return new(i||a)(d(F),d(I),d(N),d(ae),d(xe),d(Fe))}}static{this.\u0275cmp=b({type:a,selectors:[["app-displays-participant-file"]],decls:3,vars:4,consts:[[3,"downloadChange","pageTitle","isLoading","navigationLinks"],[1,"no-files"],["loading","lazy","type","application/pdf",1,"pdf",3,"src"],["loading","lazy",1,"image",3,"src"],["loading","lazy","type","application/pdf",1,"pdf",3,"load","error","src"],["loading","lazy",1,"image",3,"load","error","src"]],template:function(i,t){i&1&&(r(0,"app-display-files",0),g("downloadChange",function(){return t.downloadFile()}),C(1,$t,2,1)(2,Ht,3,0,"div",1),p()),i&2&&(l("pageTitle",t.pageTitle)("isLoading",t.isLoading)("navigationLinks",t.navigationLink),c(),D(t.safeUrl?1:2))},dependencies:[ce,T],styles:[".image[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.pdf[_ngcontent-%COMP%]{width:40%;min-height:100vh}.no-files[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:2em;height:50vh}a[_ngcontent-%COMP%]{position:relative;color:#266e99;font-weight:700;font-size:22px}a[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}a[_ngcontent-%COMP%]:hover{color:purple}"]})}}return a})();var zt=[{path:"add",component:he,canActivate:[S,M],data:{roles:["super admin","supervisor","lcu"]}},{path:":participantId/detail",component:H,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu"]}},{path:":participantId/profile/personal",component:H,canActivate:[S,M,O],data:{roles:["user"]}},{path:":participantId/profile/account",component:H,canActivate:[S,M,O],data:{roles:["user"]}},{path:":participantId/edit",component:ge,canActivate:[S,M],data:{roles:["super admin","lcu","user"]}},{path:":participantId/id-card",component:fe,canActivate:[S,M],data:{roles:["super admin","supervisor","lcu","user"]}},{path:":participantId/sim-a",component:R,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu","user"]}},{path:":participantId/sim-b",component:R,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu","user"]}},{path:":participantId/ktp",component:R,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu","user"]}},{path:":participantId/surat-sehat-buta-warna",component:R,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu","user"]}},{path:":participantId/surat-bebas-narkoba",component:R,canActivate:[S,M,O],data:{roles:["super admin","supervisor","lcu","user"]}},{path:"",component:me,canActivate:[S,M],data:{roles:["super admin","supervisor","lcu","user"]}},{path:"**",redirectTo:"",pathMatch:"full"}],dt=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=ie({type:a})}static{this.\u0275inj=te({imports:[ve.forChild(zt),ve]})}}return a})();var fa=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=ie({type:a})}static{this.\u0275inj=te({imports:[T,E,Ge,dt,me,he,H,ge,fe,R]})}}return a})();export{fa as ParticipantModule};
