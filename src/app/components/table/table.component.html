<table>
  <thead>
    <tr>
      @for (column of columns; track $index) {
        <th [ngClass]="{ 'hidden': column.field === 'action' && !hasActionColumn(), 'active-sort': sortField === column.field }"
            (click)="handleSort(column.field)"
            style="cursor:pointer; user-select:none;">
          <span class="th-content">
            {{ column.header }}
            <span class="sort-icons">
              <!-- Heroicons chevron-up (asc) -->
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"
                [ngClass]="{'active': sortField === column.field && sortDirection === 'asc'}">
                <path d="M6 12l4-4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <!-- Heroicons chevron-down (desc) -->
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"
                [ngClass]="{'active': sortField === column.field && sortDirection === 'desc'}">
                <path d="M6 8l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </span>
        </th>
      }
    </tr>
  </thead>
  <tbody>
    @if (!isLoading) {
      @if(sortedData.length > 0) {
        @for (item of sortedData; track $index) {
          <tr>
            @for (column of columns; track $index) {
              <td [class.hidden]="column.field === 'action' && !hasActionColumn()">
                @if (column.field !== 'action') {
                  @if (column.field === 'kurikulumSilabus') {
                    <a [routerLink]="item.kurikulumSilabus">Lihat</a>
                  } @else if (column.field === 'sim') {
                    <a [routerLink]="item.sim" [state]="state">Lihat</a>
                  } @else if (column.field === 'expSuratSehatButaWarna') {
                    <a [routerLink]="item.expSuratSehatButaWarna.value" [state]="state">{{ item.expSuratSehatButaWarna.label }}</a>
                  } @else if (column.field === 'expSuratBebasNarkoba') {
                    <a [routerLink]="item.expSuratBebasNarkoba.value" [state]="state">{{ item.expSuratBebasNarkoba.label }}</a>
                  } @else if (column.field === 'eSign') {
                    <a [routerLink]="item.eSign">lihat</a>
                  } @else {
                    {{ item[column.field] }}
                  }
                } @else {
                  <app-icon-action [printLink]="item.printLink"[editLink]="item.editLink" [delete]="item.deleteMethod" [detailLink]="item.detailLink" [select]="item.select" [state]="state" [certificateState]="certificateState"></app-icon-action>
                }
              </td>
            }
          </tr>
        }
      }
    } @else {
      <tr *ngFor="let _ of [].constructor(placeholderRows)">
        @for (column of columns; track $index) {
          <td [class.hidden]="column.field === 'action' && !hasActionColumn()">
            <div class="placeholder"></div>
          </td>
        }
      </tr>
    }
  </tbody>
</table>

@if (!isLoading && data.length === 0) {
  <p>Data Tidak ditemukan!!</p>
}

