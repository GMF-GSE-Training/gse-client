<app-header></app-header>

<div class="dashboard-container">
  <!-- Main Dashboard Section -->
  <div class="dashboard-section">
    <!-- Dashboard Charts Grid -->
    <div class="charts-grid">
      <app-realisasi-cot-chart 
        [dashboardData]="dashboardData" 
        [isLoading]="isLoadingDashboard"
        [selectedYear]="selectedYear"
        [availableYears]="availableYears"
        (yearChange)="onYearSelected($event)">
      </app-realisasi-cot-chart>
      <app-data-pemegang-kompetensi-gse-operator></app-data-pemegang-kompetensi-gse-operator>
      <app-data-total-sertifikat-aktif></app-data-total-sertifikat-aktif>
      <app-data-jumlah-pemegang-sertifikat></app-data-jumlah-pemegang-sertifikat>
    </div>
  </div>

  <!-- COT Table Section -->
  <div class="cot-section">
    <div class="cot-header">
      <h3 class="cot-title">Calendar of Training</h3>
      <button class="refresh-btn" (click)="refreshData()" [disabled]="isLoading">
        <svg class="refresh-icon" viewBox="0 0 24 24" [class.spin]="isLoading">
          <path
            d="M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
          />
        </svg>
      </button>
    </div>

    <div class="cot-content">
      <div class="loading" *ngIf="isLoading">Loading...</div>
      <app-table 
        *ngIf="!isLoading" 
        [columns]="columns" 
        [data]="cot"
        [sortBy]="sortBy"
        [sortOrder]="sortOrder"
        (sortChange)="onSortChange($event)"
      ></app-table>
    </div>

    <div class="pagination-wrapper">
      <app-pagination
        [currentPage]="currentPage"
        [totalPages]="totalPages"
        (pageChange)="onPageChanged($event)"
      ></app-pagination>
    </div>
  </div>
</div>
